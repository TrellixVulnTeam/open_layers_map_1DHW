{"id":"iRdz","dependencies":[{"name":"/Users/OKMG/Desktop/Work/open_layers_map/package.json","includedInParent":true,"mtime":1658712170300},{"name":"/Users/OKMG/Desktop/Work/open_layers_map/node_modules/ol/package.json","includedInParent":true,"mtime":1658712211657},{"name":"../style/expressions.js","loc":{"line":5,"column":73},"parent":"/Users/OKMG/Desktop/Work/open_layers_map/node_modules/ol/webgl/ShaderBuilder.js","resolved":"/Users/OKMG/Desktop/Work/open_layers_map/node_modules/ol/style/expressions.js"}],"generated":{"js":"\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.parseLiteralStyle=o,exports.ShaderBuilder=void 0;var e=require(\"../style/expressions.js\"),t=function(){function e(){this.uniforms=[],this.attributes=[],this.varyings=[],this.sizeExpression=\"vec2(1.0)\",this.rotationExpression=\"0.0\",this.offsetExpression=\"vec2(0.0)\",this.colorExpression=\"vec4(1.0)\",this.texCoordExpression=\"vec4(0.0, 0.0, 1.0, 1.0)\",this.discardExpression=\"false\",this.rotateWithView=!1}return e.prototype.addUniform=function(e){return this.uniforms.push(e),this},e.prototype.addAttribute=function(e){return this.attributes.push(e),this},e.prototype.addVarying=function(e,t,o){return this.varyings.push({name:e,type:t,expression:o}),this},e.prototype.setSizeExpression=function(e){return this.sizeExpression=e,this},e.prototype.setRotationExpression=function(e){return this.rotationExpression=e,this},e.prototype.setSymbolOffsetExpression=function(e){return this.offsetExpression=e,this},e.prototype.setColorExpression=function(e){return this.colorExpression=e,this},e.prototype.setTextureCoordinateExpression=function(e){return this.texCoordExpression=e,this},e.prototype.setFragmentDiscardExpression=function(e){return this.discardExpression=e,this},e.prototype.setSymbolRotateWithView=function(e){return this.rotateWithView=e,this},e.prototype.getSizeExpression=function(){return this.sizeExpression},e.prototype.getOffsetExpression=function(){return this.offsetExpression},e.prototype.getColorExpression=function(){return this.colorExpression},e.prototype.getTextureCoordinateExpression=function(){return this.texCoordExpression},e.prototype.getFragmentDiscardExpression=function(){return this.discardExpression},e.prototype.getSymbolVertexShader=function(e){var t=this.rotateWithView?\"u_offsetScaleMatrix * u_offsetRotateMatrix\":\"u_offsetScaleMatrix\",o=this.attributes,i=this.varyings;return e&&(o=o.concat(\"vec4 a_hitColor\"),i=i.concat({name:\"v_hitColor\",type:\"vec4\",expression:\"a_hitColor\"})),\"precision mediump float;\\nuniform mat4 u_projectionMatrix;\\nuniform mat4 u_offsetScaleMatrix;\\nuniform mat4 u_offsetRotateMatrix;\\nuniform float u_time;\\nuniform float u_zoom;\\nuniform float u_resolution;\\n\"+this.uniforms.map(function(e){return\"uniform \"+e+\";\"}).join(\"\\n\")+\"\\nattribute vec2 a_position;\\nattribute float a_index;\\n\"+o.map(function(e){return\"attribute \"+e+\";\"}).join(\"\\n\")+\"\\nvarying vec2 v_texCoord;\\nvarying vec2 v_quadCoord;\\n\"+i.map(function(e){return\"varying \"+e.type+\" \"+e.name+\";\"}).join(\"\\n\")+\"\\nvoid main(void) {\\n  mat4 offsetMatrix = \"+t+\";\\n  vec2 halfSize = \"+this.sizeExpression+\" * 0.5;\\n  vec2 offset = \"+this.offsetExpression+\";\\n  float angle = \"+this.rotationExpression+\";\\n  float offsetX;\\n  float offsetY;\\n  if (a_index == 0.0) {\\n    offsetX = (offset.x - halfSize.x) * cos(angle) + (offset.y - halfSize.y) * sin(angle);\\n    offsetY = (offset.y - halfSize.y) * cos(angle) - (offset.x - halfSize.x) * sin(angle);\\n  } else if (a_index == 1.0) {\\n    offsetX = (offset.x + halfSize.x) * cos(angle) + (offset.y - halfSize.y) * sin(angle);\\n    offsetY = (offset.y - halfSize.y) * cos(angle) - (offset.x + halfSize.x) * sin(angle);\\n  } else if (a_index == 2.0) {\\n    offsetX = (offset.x + halfSize.x) * cos(angle) + (offset.y + halfSize.y) * sin(angle);\\n    offsetY = (offset.y + halfSize.y) * cos(angle) - (offset.x + halfSize.x) * sin(angle);\\n  } else {\\n    offsetX = (offset.x - halfSize.x) * cos(angle) + (offset.y + halfSize.y) * sin(angle);\\n    offsetY = (offset.y + halfSize.y) * cos(angle) - (offset.x - halfSize.x) * sin(angle);\\n  }\\n  vec4 offsets = offsetMatrix * vec4(offsetX, offsetY, 0.0, 0.0);\\n  gl_Position = u_projectionMatrix * vec4(a_position, 0.0, 1.0) + offsets;\\n  vec4 texCoord = \"+this.texCoordExpression+\";\\n  float u = a_index == 0.0 || a_index == 3.0 ? texCoord.s : texCoord.p;\\n  float v = a_index == 2.0 || a_index == 3.0 ? texCoord.t : texCoord.q;\\n  v_texCoord = vec2(u, v);\\n  u = a_index == 0.0 || a_index == 3.0 ? 0.0 : 1.0;\\n  v = a_index == 2.0 || a_index == 3.0 ? 0.0 : 1.0;\\n  v_quadCoord = vec2(u, v);\\n\"+i.map(function(e){return\"  \"+e.name+\" = \"+e.expression+\";\"}).join(\"\\n\")+\"\\n}\"},e.prototype.getSymbolFragmentShader=function(e){var t=e?\"  if (gl_FragColor.a < 0.1) { discard; } gl_FragColor = v_hitColor;\":\"\",o=this.varyings;return e&&(o=o.concat({name:\"v_hitColor\",type:\"vec4\",expression:\"a_hitColor\"})),\"precision mediump float;\\nuniform float u_time;\\nuniform float u_zoom;\\nuniform float u_resolution;\\n\"+this.uniforms.map(function(e){return\"uniform \"+e+\";\"}).join(\"\\n\")+\"\\nvarying vec2 v_texCoord;\\nvarying vec2 v_quadCoord;\\n\"+o.map(function(e){return\"varying \"+e.type+\" \"+e.name+\";\"}).join(\"\\n\")+\"\\nvoid main(void) {\\n  if (\"+this.discardExpression+\") { discard; }\\n  gl_FragColor = \"+this.colorExpression+\";\\n  gl_FragColor.rgb *= gl_FragColor.a;\\n\"+t+\"\\n}\"},e}();function o(o){var i=o.symbol,s=void 0!==i.size?i.size:1,r=i.color||\"white\",n=i.textureCoord||[0,0,1,1],a=i.offset||[0,0],f=void 0!==i.opacity?i.opacity:1,u=void 0!==i.rotation?i.rotation:0,l={inFragmentShader:!1,variables:[],attributes:[],stringLiteralsMap:{}},p=(0,e.expressionToGlsl)(l,s,e.ValueTypes.NUMBER_ARRAY|e.ValueTypes.NUMBER),x=(0,e.expressionToGlsl)(l,a,e.ValueTypes.NUMBER_ARRAY),c=(0,e.expressionToGlsl)(l,n,e.ValueTypes.NUMBER_ARRAY),d=(0,e.expressionToGlsl)(l,u,e.ValueTypes.NUMBER),h={inFragmentShader:!0,variables:l.variables,attributes:[],stringLiteralsMap:l.stringLiteralsMap},v=(0,e.expressionToGlsl)(h,r,e.ValueTypes.COLOR),y=(0,e.expressionToGlsl)(h,f,e.ValueTypes.NUMBER),m=\"1.0\",g=\"vec2(\"+(0,e.expressionToGlsl)(h,s,e.ValueTypes.NUMBER_ARRAY|e.ValueTypes.NUMBER)+\").x\";switch(i.symbolType){case\"square\":case\"image\":break;case\"circle\":m=\"(1.0-smoothstep(1.-4./\"+g+\",1.,dot(v_quadCoord-.5,v_quadCoord-.5)*4.))\";break;case\"triangle\":var _=\"(v_quadCoord*2.-1.)\",E=\"(atan(\"+_+\".x,\"+_+\".y))\";m=\"(1.0-smoothstep(.5-3./\"+g+\",.5,cos(floor(.5+\"+E+\"/2.094395102)*2.094395102-\"+E+\")*length(\"+_+\")))\";break;default:throw new Error(\"Unexpected symbol type: \"+i.symbolType)}var b=(new t).setSizeExpression(\"vec2(\"+p+\")\").setRotationExpression(d).setSymbolOffsetExpression(x).setTextureCoordinateExpression(c).setSymbolRotateWithView(!!i.rotateWithView).setColorExpression(\"vec4(\"+v+\".rgb, \"+v+\".a * \"+y+\" * \"+m+\")\");if(o.filter){var C=(0,e.expressionToGlsl)(h,o.filter,e.ValueTypes.BOOLEAN);b.setFragmentDiscardExpression(\"!\"+C)}var S={};if(h.variables.forEach(function(t){b.addUniform(\"float u_\"+t),S[\"u_\"+t]=function(){if(!o.variables||void 0===o.variables[t])throw new Error(\"The following variable is missing from the style: \"+t);var i=o.variables[t];return\"string\"==typeof i&&(i=(0,e.getStringNumberEquivalent)(l,i)),void 0!==i?i:-9999999}}),\"image\"===i.symbolType&&i.src){var z=new Image;z.src=i.src,b.addUniform(\"sampler2D u_texture\").setColorExpression(b.getColorExpression()+\" * texture2D(u_texture, v_texCoord)\"),S.u_texture=z}return h.attributes.forEach(function(e){-1===l.attributes.indexOf(e)&&l.attributes.push(e),b.addVarying(\"v_\"+e,\"float\",\"a_\"+e)}),l.attributes.forEach(function(e){b.addAttribute(\"float a_\"+e)}),{builder:b,attributes:l.attributes.map(function(t){return{name:t,callback:function(o,i){var s=i[t];return\"string\"==typeof s&&(s=(0,e.getStringNumberEquivalent)(l,s)),void 0!==s?s:-9999999}}}),uniforms:S}}exports.ShaderBuilder=t;"},"sourceMaps":null,"error":null,"hash":"583a37697ba558b3786e4ce27779f86b","cacheData":{"env":{}}}